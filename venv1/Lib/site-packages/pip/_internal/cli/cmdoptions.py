"""
Shared CLI options and option groups for a command-line tool
"""

from __future__ import annotations
import logging
import os
import pathlib
from functools import partial
from optparse import Option, OptionGroup, OptionParser, Values, SUPPRESS_HELP

logger = logging.getLogger(__name__)

# ------------------------
# Helper functions
# ------------------------

def raise_option_error(parser: OptionParser, option: Option, msg: str) -> None:
    """Raise an option parsing error using parser.error()."""
    msg = f"{option} error: {msg}"
    parser.error(msg)

def _path_option_check(option: Option, opt: str, value: str) -> str:
    return os.path.expanduser(value)

# ------------------------
# Option definitions
# ------------------------

help_: callable = partial(
    Option, "-h", "--help", dest="help", action="help", help="Show help."
)

debug_mode: callable = partial(
    Option,
    "--debug",
    dest="debug_mode",
    action="store_true",
    default=False,
    help="Show detailed error traceback on exceptions.",
)

isolated_mode: callable = partial(
    Option,
    "--isolated",
    dest="isolated_mode",
    action="store_true",
    default=False,
    help="Run in isolated mode, ignoring environment variables and config.",
)

verbose: callable = partial(
    Option,
    "-v",
    "--verbose",
    dest="verbose",
    action="count",
    default=0,
    help="Increase verbosity, can be used multiple times.",
)

no_color: callable = partial(
    Option,
    "--no-color",
    dest="no_color",
    action="store_true",
    default=False,
    help="Disable colored output.",
)

log: callable = partial(
    Option,
    "--log",
    "--log-file",
    dest="log",
    metavar="path",
    type="string",
    help="Path to a log file.",
)

no_input: callable = partial(
    Option,
    "--no-input",
    dest="no_input",
    action="store_true",
    default=False,
    help="Disable prompting for input.",
)

cache_dir: callable = partial(
    Option,
    "--cache-dir",
    dest="cache_dir",
    type="string",
    metavar="dir",
    help="Store cache data in the given directory.",
)

no_cache: callable = partial(
    Option,
    "--no-cache-dir",
    dest="cache_dir",
    action="store_true",
    help="Disable the cache.",
)

# ------------------------
# Option groups
# ------------------------

general_group: dict[str, any] = {
    "name": "General Options",
    "options": [
        help_,
        debug_mode,
        isolated_mode,
        verbose,
        log,
        no_input,
        cache_dir,
        no_cache,
        no_color,
    ],
}

index_group: dict[str, any] = {
    "name": "Package Index Options",
    "options": [
        # Placeholders for index options
    ],
}